{% extends "base.html" %}

{% block content %}

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-success">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}

    <h2>Job Applications</h2>

    <a href="{% url 'job_create' %}"> Add a New Job</a> 

    {% for status_category in status_categories %}
        <h3>{{ status_category }}</h3>
        {% for job in jobs %}
    {% if job.status == status_category %}
        <p>
            <!-- Status Dropdown -->
            <form method="POST" action="{% url 'update_status' job.id %}">
                {% csrf_token %}
                <select name="status" onchange="this.form.submit()">
                    {% for choice in job.STATUS_CHOICES %}
                        <option value="{{ choice.0 }}" {% if job.status == choice.0 %}selected{% endif %}>
                            {{ choice.1 }}
                        </option>
                    {% endfor %}
                </select>
            </form>

            <!-- Job Details -->
            {{ job.company_name }} - {{ job.job_title }}

            <!-- Edit & Delete Buttons -->
            <a href="{% url 'job_update' job.id %}"> Edit</a>
            <a href="{% url 'job_delete' job.id %}"> Delete</a>
        </p>
    {% endif %}
{% endfor %}

    {% endfor %}

{% endblock %}
